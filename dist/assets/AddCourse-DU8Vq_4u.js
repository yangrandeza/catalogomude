import{a as z,b as A,r as N,j as e,d as o}from"./index-CQAG8VK0.js";import{z as c,u as E,F as P,a as n,b as d,c as m,d as h,e as x,t as q}from"./form-C8Jww-IK.js";import{I as p}from"./input-Cw1N9oJN.js";import{T as M,X as k,I as B,U as T}from"./textarea-Bz3SmYKW.js";import{c as R}from"./courseService-BuGxHIX5.js";import{A as _}from"./arrow-left-DubhSE8H.js";const C=100*1024*1024,D=["image/jpeg","image/jpg","image/png","image/webp"],L=["application/zip","application/x-zip-compressed"],O=c.object({name:c.string().min(1,"Nome do curso é obrigatório"),description:c.string().optional(),category:c.string().min(1,"Categoria do curso é obrigatória"),coverImage:c.instanceof(File).refine(t=>t.size<=C,"A imagem deve ter no máximo 100MB").refine(t=>D.includes(t.type),"Apenas arquivos .jpg, .jpeg, .png e .webp são aceitos").optional().nullable(),scormFile:c.instanceof(File).refine(t=>t.size<=C,"O arquivo deve ter no máximo 100MB").refine(t=>L.includes(t.type),"Apenas arquivos .zip são aceitos").nullable()}),J=()=>{const t=z(),{toast:g}=A(),[j,b]=N.useState(null),[w,v]=N.useState(!1),i=E({resolver:q(O),defaultValues:{name:"",description:"",category:"",coverImage:null,scormFile:null}}),I=async s=>{v(!0);const r={...s,description:s.description??"",coverImage:s.coverImage??null};try{await R(r),g({title:"Sucesso",description:"Curso adicionado com sucesso."}),t("/admin")}catch{g({title:"Erro",description:"Não foi possível adicionar o curso.",variant:"destructive"})}finally{v(!1)}},y=s=>{var l;const r=(l=s.target.files)==null?void 0:l[0];if(r){i.setValue("coverImage",r);const a=new FileReader;a.onload=()=>{b(a.result)},a.readAsDataURL(r)}},F=()=>{i.setValue("coverImage",null),b(null)};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-indigo-800 via-purple-800 to-purple-900",children:e.jsxs("div",{className:"backdrop-blur-xl bg-white/15 rounded-2xl p-8 shadow-2xl",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-8",children:[e.jsx(o,{variant:"ghost",size:"icon",onClick:()=>t("/admin"),className:"text-white hover:bg-white/20",children:e.jsx(_,{size:18})}),e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Adicionar Novo Curso"})]}),e.jsx(P,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(I),className:"space-y-6",children:[e.jsx(n,{control:i.control,name:"name",render:({field:s})=>e.jsxs(d,{children:[e.jsx(m,{className:"text-white",children:"Nome do Curso *"}),e.jsx(h,{children:e.jsx(p,{placeholder:"Digite o nome do curso",...s,className:"bg-white/20 border-white/30 text-white placeholder-white/70 focus:border-white/50 focus:ring-white/30"})}),e.jsx(x,{className:"text-red-200"})]})}),e.jsx(n,{control:i.control,name:"description",render:({field:s})=>e.jsxs(d,{children:[e.jsx(m,{className:"text-white",children:"Descrição"}),e.jsx(h,{children:e.jsx(M,{placeholder:"Digite a descrição do curso",...s,rows:4,className:"bg-white/20 border-white/30 text-white placeholder-white/70 focus:border-white/50 focus:ring-white/30"})}),e.jsx(x,{className:"text-red-200"})]})}),e.jsx(n,{control:i.control,name:"category",render:({field:s})=>e.jsxs(d,{children:[e.jsx(m,{className:"text-white",children:"Categoria *"}),e.jsx(h,{children:e.jsx(p,{placeholder:"Digite a categoria do curso",...s,value:s.value,className:"bg-white/20 border-white/30 text-white placeholder-white/70 focus:border-white/50 focus:ring-white/30"})}),e.jsx(x,{className:"text-red-200"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(n,{control:i.control,name:"coverImage",render:()=>e.jsxs(d,{children:[e.jsx(m,{className:"text-white",children:"Imagem de Capa"}),e.jsx(h,{children:e.jsx("div",{className:"space-y-4",children:j?e.jsxs("div",{className:"relative h-60 w-full rounded-md overflow-hidden border border-white/30",children:[e.jsx("img",{src:j,alt:"Prévia da capa",className:"h-full w-full object-cover"}),e.jsx(o,{type:"button",variant:"destructive",size:"icon",className:"absolute top-2 right-2 bg-red-500/80 hover:bg-red-500/90 text-white",onClick:F,children:e.jsx(k,{size:16})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-60 border-2 border-dashed rounded-md border-white/30 p-6 bg-white/10",children:[e.jsx(B,{size:48,className:"text-white/60 mb-4"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-white/80 mb-2",children:"Arraste e solte a imagem aqui ou clique para escolher"}),e.jsx("p",{className:"text-xs text-white/70",children:"JPG, PNG ou WebP (max. 100MB)"})]}),e.jsx(p,{type:"file",className:"hidden",accept:"image/jpeg,image/jpg,image/png,image/webp",id:"coverImage",onChange:y}),e.jsx(o,{type:"button",variant:"secondary",className:"mt-4 bg-white/20 hover:bg-white/30 text-white border-white/30",onClick:()=>{var s;return(s=document.getElementById("coverImage"))==null?void 0:s.click()},children:"Escolher Imagem"})]})})}),e.jsx(x,{className:"text-red-200"})]})}),e.jsx(n,{control:i.control,name:"scormFile",render:({field:{value:s,onChange:r,...l}})=>{var a;return e.jsxs(d,{children:[e.jsx(m,{className:"text-white",children:"Pacote SCORM (.zip) *"}),e.jsx(h,{children:e.jsxs("div",{className:"flex flex-col items-center justify-center h-60 border-2 border-dashed rounded-md border-white/30 p-6 bg-white/10",children:[e.jsx(T,{size:48,className:"text-white/60 mb-4"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-white/80 mb-2",children:"Arraste e solte o arquivo zip aqui ou clique para escolher"}),e.jsx("p",{className:"text-xs text-white/70",children:"Arquivo ZIP contendo o curso SCORM (max. 100MB)"})]}),e.jsx(p,{type:"file",className:"hidden",accept:".zip,application/zip,application/x-zip-compressed",id:"scormFile",onChange:u=>{var f;const S=((f=u.target.files)==null?void 0:f[0])||null;r(S)},...l}),e.jsx(o,{type:"button",variant:"secondary",className:"mt-4 bg-white/20 hover:bg-white/30 text-white border-white/30",onClick:()=>{var u;return(u=document.getElementById("scormFile"))==null?void 0:u.click()},children:"Escolher Arquivo"}),i.watch("scormFile")&&e.jsxs("p",{className:"mt-2 text-sm text-white/80",children:["Arquivo selecionado: ",(a=i.watch("scormFile"))==null?void 0:a.name]})]})}),e.jsx(x,{className:"text-red-200"})]})}})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(o,{type:"button",variant:"outline",onClick:()=>t("/admin"),className:"bg-white/20 hover:bg-white/30 text-white border-white/30",children:"Cancelar"}),e.jsx(o,{type:"submit",disabled:w,className:"bg-indigo-500 hover:bg-indigo-600 text-white",children:w?"Salvando...":"Salvar Curso"})]})]})})]})})};export{J as default};
